<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Check if your contracts are climate aligned</title>
	<link rel="stylesheet" href="https://chancerylaneproject.org/wp-content/themes/contracts-for-change/dist/css/main.css?v=1.2.148">
	<link rel='stylesheet' id='wp-block-library-css' href='https://chancerylaneproject.org/wp-includes/css/dist/block-library/style.min.css?ver=6.7.1' media='all' />
	<link rel='stylesheet' id='cfc-style-css' href='https://chancerylaneproject.org/wp-content/themes/contracts-for-change/style.css?ver=1.0.2' media='all' />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css" />
	<!-- Fathom - beautiful, simple website analytics -->
	<script src="https://cdn.usefathom.com/script.js" data-site="TGKQMOXQ" defer></script>
	<!-- / Fathom -->
	<link rel="icon" href="https://chancerylaneproject.org/wp-content/themes/contracts-for-change/dist/images/fav/favicon.svg" type="image/svg+xml">
	<style class='wp-fonts-local'>
	@font-face{font-family:public-sans;font-style:normal;font-weight:400;font-display:fallback;src:url('https://chancerylaneproject.org/wp-content/themes/contracts-for-change/dist/fonts/public-sans/PublicSans-Regular.woff2') format('woff2');font-stretch:normal;}
	@font-face{font-family:public-sans;font-style:italic;font-weight:400;font-display:fallback;src:url('https://chancerylaneproject.org/wp-content/themes/contracts-for-change/dist/fonts/public-sans/PublicSans-Italic.woff2') format('woff2');font-stretch:normal;}
	@font-face{font-family:public-sans;font-style:normal;font-weight:700;font-display:fallback;src:url('https://chancerylaneproject.org/wp-content/themes/contracts-for-change/dist/fonts/public-sans/PublicSans-Bold.woff2') format('woff2');font-stretch:normal;}
	@font-face{font-family:public-sans;font-style:italic;font-weight:700;font-display:fallback;src:url('https://chancerylaneproject.org/wp-content/themes/contracts-for-change/dist/fonts/public-sans/PublicSans-BoldItalic.woff2') format('woff2');font-stretch:normal;}
	</style>

  <style id='wp-block-library-theme-inline-css'>
	  :root {
		--border: #b1b4b6;
		--radius: 0.5rem;

		--success: #00703c;
		--error: #d4351c;
		--error-hover: #942514;

		--light: 300;
		--regular: 400;
		--medium: 500;
		--bold: 700;

		--navy-110: #0B183F;
		--navy-90: #20305e;
		--navy-80: #4B5576;
		--navy-60: #6E7691;
		--navy-40: #A5AABE;
		--navy-20: #D3D5E3;
		--navy-8: #EDEEF5;
		--navy-4: #F5F6FC;

		--magenta-80: #DE50A3;
		--magenta-60: #E779BB;
		--magenta-40: #EFAAD5;
		--magenta-20: #FCD5EE;
		--magenta-8: #FDECF7;
	  }

	  body {
		background: #1C2B58;
		color:#1C2B58;
		  font-size:17px;
		font-family:"public-sans", sans-serif;
	  }
	  .logo-wrapper {
		margin: 50px auto 0;
		max-width: 600px;
	  }
	  .logo-wrapper svg {
		fill: #FFF;
		width: 185px;
		height: 53px;
	  }
	  .center-wrapper {
		background: #FFF;
		position: relative;
		max-width: 600px;
		padding: 2.2em !important;
		border-radius: 10px;
		margin: 20px auto 50px;
		overflow: hidden;
	  }
	  .center-wrapper h1 {
		font-size: 2.5em;
		margin-bottom: 0.75em;
	  }
	  .center-wrapper ul {
		list-style-position: outside;
		margin-bottom:2em;
		padding-left: 1em;
		margin-top: 0;
	  }
	  .center-wrapper ul li {
		margin-bottom: 0.5em;
	  }
	  .cfc-button {
		padding: 13px 30px;
		color: #FFF  !important;
		background: #d7288b !important;
	  }
	  .cfc-button:hover {
		background:#a80771 !important;
	  }
	  .border-section {
		margin-top: 40px;
		padding: 10px 0 0;
		float: left;
		clear: both;
	  }
	  #clauseDetails {

	  }
	  .clause-wrapper {
		border: 1px solid rgb(211, 213, 227);
		padding: 25px 25px;
		border-radius: 8px;
		margin: 25px 0;
		position: relative;
	  }
	  .clause-wrapper:hover {
		background: #F5F6FC;
	  }
	  .clause-wrapper:hover h4 {
		text-decoration: underline;
	  }
	  .clause-wrapper .childs-name {
		color:rgb(215, 40, 139);
		font-weight: bold;
		margin-bottom: 5px;
	  }
	  .clause-wrapper h4 {
		font-size: 21px;
		line-height: 1.3;
		margin-bottom: 0.3em;
	  }
	  .clause-wrapper p.excerpt {
		font-size: 16px;
		line-height: 1.35;
		margin-bottom: 10px;
	  }
	  .clause-wrapper p.meta-data {
		font-size: 16px;
		color: rgb(110, 118, 145);
		margin: 0 0 5px 0;
	  }
	  .clause-wrapper p.meta-data span.cfc-leadin {
		font-weight: bold;
	  }
	  .clause-wrapper a.hot-spot {
		position: absolute;
		width: 100%;
		height: 100%;
		top: 0;
		left: 0;
	  }
	  .confidence-indicator {
		position: absolute;
		display: inline-block;
		background: #F5F6FC;
		padding: 4px 10px 4px 24px;
		border-radius: 3px;
		right: 10px;
		top: 21px;
		font-size: 12px;
	  }
	  .clause-wrapper:hover .confidence-indicator {
		background: #FFF;
	  }
	  .confidence-indicator .signal {
		display: block;
		width: 10px;
		height: 10px;
		border-radius: 100%;
		position: absolute;
		top: 6px;
		left: 8px;
	  }
	  .confidence-indicator .signal.very-good {
		background: green;
	  }
	  .confidence-indicator .signal.good {
		background: darkmagenta;
	  }
	  .confidence-indicator .signal.acceptable {
		background: orange;
	  }


	  .detection-result .confidence-indicator {
		position: relative;
		top: 0px;
		right: auto;
		padding: 5px 7px;
		color: #FFF;
		font-weight: bold;
		line-height: 1;
		font-size: 0.8em;
	  }
	  .detection-result .confidence-indicator .signal {
		left: auto;
		right: 8px;
	  }

	  h3 {
		position: relative;
		margin-top: 1.5em;
	  }
	  h3 .confidence-indicator {
		position: relative;
		top: -2px;
		right: auto;
	  }
	  button.custom-btn {
		border: 1px solid rgb(211, 213, 227);
		padding: 0 20px 20px;
		border-radius: 8px;
		cursor: pointer;
		background: #F5F6FC;
		color: #1c2b58;
		max-width: 170px;
		margin-right: 20px;
	  }
	  button.custom-btn:hover {
		background: #dbddf3;
	  }
	  button.custom-btn span {
		display: block;
		font-weight: bold;
	  }
	button.custom-btn:focus-within {
	  outline: 2px solid #ffdd00;
	}
	h2 {
	  margin-bottom: 0.4em;
	}
	.detection-result .result-blk {
	  display: block;
	  padding: 20px;
	  background: #f5f6fc;
	  font-weight: normal;
	  float: left;
	  width: 100%;
	  border-radius: 3px;
	  border: 1px solid rgb(211, 213, 227);
	}
	.detection-result.single span.desc {
	  color: #1C2B58;
	}
	.detection-result.single strong {
	  display: block;
	font-size: 1.3em;
	}
	.detection-result.multiple {
	  display: block;
	  width: 100%;
	  float: left;
	}
	.detection-result.multiple .result-blk {
	  display: block;
	  margin: 0 0 15px 0;
	  float: left;
	  width: 100%;
	  border-radius: 3px;
	  border: 1px solid rgb(211, 213, 227);
	}
	.detection-result.multiple .result-blk span {
	}
	.detection-result.multiple .result-blk span.desc {
		color: #0B183F;
		margin-bottom: 5px;
	}
	.detection-result.multiple .result-blk span.percentage {
	font-weight: bold;
	}
	.detection-result .result-blk a {
	  color: rgb(33, 59, 198) !important;
	  font-size: 15px;
	}
	.detection-result.single .result-blk a {
		  display: block;
	margin: 10px 0 0;
	}
	.detection-result .result-blk.extremely-likely {
	  border-left: 6px solid #0b9216;
	  color: #0b9216;
	}
	.detection-result .result-blk.very-likely {
	  border-left: 6px solid #7bae0c;
	  color: #7bae0c;
	}
	.detection-result .result-blk.likely {
	  border-left: 6px solid #ac8500;
	  color: #ac8500;
	}
	.detection-result .result-blk.unlikely {
	  border-left: 6px solid #d05c15;
	  color: #d05c15;
	}
	.detection-result .result-blk.unknown {
	  border-left: 6px solid #D70000;
	  color: #D70000;
	}
	.govuk-form-group {
	  background: #f9f8f8;
	padding: 15px;
	border-radius: 5px;
	border: 1px solid #cecece;
	}
	.govuk-form-group h2 {
	  margin-bottom: 0.5em;
	}
	.contract-listing {
	 background: #FFF;
	padding: 30px;
	margin: 20px 0 0 0;
	border: 1px solid #d8d8d8;
	overflow: scroll;
	color: #1c2b58;
		  border-radius: 10px;
		  max-width: 600px;
	}
	.contract-listing h1 {
	  margin: 0 0 20px;
	}
	.contract-listing ul {
	  margin: 0;
	  list-style: none;
	  padding: 0;
	  font-weight: bold;
	}
   .contract-listing ul li {
	  border: 1px solid #e4e4e4;
	  padding: 10px;
	  font-size: 15px;
	  margin-bottom: 11px;
	  background: #f9f8f8;
	  border-radius: 5px;
   }
	.contract-listing ul li a {
	  font-size: 15px;
	  float: right;
	  font-weight: normal;
	}
	.fancybox__backdrop {
	  background: #0c17379c;
	  backdrop-filter: blur(10px);
	}
	.fancybox__content h3 {
		margin-top: 0;
	}
	.contract-listing .cfc-button {
	  margin-top: 10px;
	}
	.contact-text-preview {
	  display: block;
	  background: #f4f4f4;
	  font-family: monospace;
	  padding: 25px;
	  margin: 0 0 25px;
	}
	.contact-text-preview p {
	  margin-bottom: 1em;
	}
	.f-button.is-close-btn {
	  top: 30px !important;
	  right: calc(50% - 295px);
	  background: #121f43 !important;
	  opacity: 1 !important;
	  border-radius: 100% !important;
	  position: fixed !important;
	}
	.hidden {
		display: none;
	}
	.toggle-arrow {
	  display: inline-block;
	  margin-right: 5px;
	  cursor: pointer;
	  transform-origin: center;
	  transition: transform 0.2s ease;
	  font-size: 13px;
	}
	.highlighted-text-wrapper {
	  padding: 1.5em;
	  background: #EFEFEF;
	  font-family: monospace;
	  font-size: 13px;
	  max-height: 310px;
	  overflow: scroll;
	  margin: 15px 0;
	  border-radius: 5px;
	  box-shadow: inset 0px 3px 3px #00000024;
	}
	.fancybox__content .cfc-button {
	  margin: 0;
	  padding: 10px 15px;
	  font-size: 14px;
	}
	.fancybox__content .cfc-button--secondary {
	  background-color: white !important;
	  border: 2px solid #121f43;
	  color: #121f43 !important;
	}
	.fancybox__content .cfc-button--secondary:hover {
	  background: #121f43 !important;
	  color: #FFF !important;
	}
	.toggle-link {
	  display: block;
	  cursor: pointer;
	  margin: 10px 0;
	}
	.doc-list {
	  border-left: 4px solid darkgrey;
	  color: #1c2b58;
	  margin: 10px 6px;
	  padding-left: 15px;
	}
	.doc-list ul {
	  margin-bottom: 0;
	  line-height: 1;
	  padding-left: 13px;
	  font-size: 15px;
	}
	.doc-list ul li {
	  margin: 0;
	  padding: 5px 0;
	}
	.report-findings {
	  display: block;
	  width: 100%;
	  float: left;
	  margin: 20px 0 0;
	  background: #EFF2F6;
	  border: 1px solid #DEE5EC;
	  border-radius: 10px;
	  padding: 15px 20px;
	}
	.report-findings .report-findings-inner {
	  border: 1px solid #DEE5EC;
	  width: calc(100% + 80px);
	  padding: 30px 30px 30px 50%;
	  background: #FFF url(https://chancerylaneproject.org/wp-content/uploads/2024/12/tool-vis.png) no-repeat left top;
	  background-size: contain;
	  border-radius: 10px;
	  margin-left: -40px;
	  box-shadow: 0px 3px 0px -1px #0000000f;
	}
	.report-findings .report-findings-inner h3 {
	  margin: 0 0 10px;
	}
	.report-findings .report-findings-inner a.cfc-button {
	  margin: 12px 0 0;
	  display: inline-block;
	  padding: 10px 15px;
	  font-size: 13px;
	}
	.report-findings .report-findings-inner p {
	  font-size: 15px;
	  line-height: 1.4;
	}
	.grid-count--2 {
		grid-template-columns: repeat(2, 1fr);
		gap: 1.5em;
		margin-top: 1.5em;
	  }
	  .grid-count--2 .cfc-card__type {
		color: #d7288b;
		font-size: 15px;
	  }
	  .grid-count--2 .cfc-card__description {
		font-size: 15px;
		line-height: 20px;
	  }
	#guideReccomendations {
	  margin-top: 20px;
	}
	.govuk-phase-banner {
	  background: #ffdd00;
	}
	.govuk-phase-banner__content {
	  max-width: 600px;
	  margin: 0 auto;
	}
	.govuk-phase-banner__content__tag {
	  text-transform: uppercase;
	  font-weight: bold;
	  background: #1c2b58;
	  color: #FFF;
	  margin: 4px 10px 0 0;
	  font-size: 13px;
	}
	</style>

	<style>
		body {
			font-family: Arial, sans-serif;
		}
		.container {
			max-width: 600px;
			margin: 0 auto;
		}
		input[type="file"] {
			margin: 10px 0;
		}
		.loading {
		  margin-top: 20px;
		  padding: 20px;
		  border: 1px solid #ccc;
		  background-color: #f9f9f9;
		  border-radius: 10px;
		  font-weight: bold;
		}
		.progress-bar {
			width: 100%;
			background-color: #e0e0e0;
			border-radius: 5px;
			overflow: hidden;
			margin: 10px 0 0;
		}
		.progress-bar-inner {
		  height: 15px;
		  background-color: #d7298a;
		  width: 30%;
		  transition: width 0.5s;
		}
		.hidden {
			display: none;
		}
		.error-banner {
			background-color: #f8d7da;
			color: #721c24;
			border: 1px solid #f5c6cb;
			padding: 10px;
			margin-bottom: 20px;
			border-radius: 5px;
		}
	</style>
</head>
<body>
  <div class="govuk-phase-banner">
	<p class="govuk-phase-banner__content">
	  <strong class="govuk-tag govuk-phase-banner__content__tag">
		Prototype
	  </strong>
	  <span class="govuk-phase-banner__text">
		Send questions or feedback to <a href="mailto:digital@chancerylaneproject.org">digital@chancerylaneproject.org</a>.
		Uploaded files are not stored.
	  </span>
	</p>
  </div>
  <div class="logo-wrapper">
	<svg class="logo" xmlns="http://www.w3.org/2000/svg" width="166" height="47" viewBox="0 0 166 47"><path d="M3 3h8.671V0H1.5L0 1.5v40L1.5 43h10.171v-3H3zM34.329 0v3H43v37h-8.671v3H44.5l1.5-1.5v-40L44.5 0z"></path><path d="M23 7.5c-7.872 0-14.25 6.378-14.25 14.25S15.128 36 23 36s14.25-6.378 14.25-14.25S30.872 7.5 23 7.5zM12.579 26.12c2.948-.078 3.023-2.953 6.293-2.513 3.725.501.423 2.074.934 4.314.368 1.622 2.798 3.238 2.972 5.119-4.586-.09-8.513-2.918-10.199-6.92zm19.028-3.819c-.806.806.737 2.3.197 3.282-.541.983-1.071 1.278-1.071 2.614 0 .694.145 1.188.286 1.506a11.328 11.328 0 0 1-3.999 2.596c.896-1.351 1.76-3.523.924-6.334-.668-2.28-4.914-3.292-7.872-4.137s-.845-4.904.767-6.771c1.275-1.478 1.117-3.688.995-4.549a11.16 11.16 0 0 1 2.413.013c-.223 1.094-.436 3.2.553 5.313 1.425 3.047 3.312.089 4.825 1.612s1.435 2.329 3.037 2.142l1.4-.154c.156.748.241 1.522.241 2.316 0 .477-.039.944-.097 1.405-.604-.796-1.834-1.618-2.598-.854zM58.141 11.75h2.225V1.966h3.641V0H54.5v1.966h3.641zM67.756 7.249c0-.314.068-.591.204-.829.135-.238.322-.422.561-.553.238-.13.509-.195.812-.195.466 0 .845.146 1.138.439.293.292.439.672.439 1.138v4.502h2.13V6.778c0-.596-.13-1.121-.39-1.576s-.621-.812-1.081-1.073c-.461-.26-.989-.39-1.585-.39s-1.124.13-1.584.39a2.861 2.861 0 0 0-.643.501V0h-2.129v11.75h2.129V7.248zM76.402 11.385c.639.352 1.371.528 2.194.528.639 0 1.232-.114 1.779-.341a3.646 3.646 0 0 0 1.389-1.007l-1.251-1.251c-.239.271-.52.474-.845.609a2.795 2.795 0 0 1-1.089.203c-.444 0-.834-.095-1.17-.285a1.89 1.89 0 0 1-.929-1.262l5.723-.014a4.035 4.035 0 0 0 .114-.926c0-.748-.166-1.417-.496-2.007s-.785-1.056-1.365-1.398-1.249-.512-2.007-.512a4.113 4.113 0 0 0-3.583 2.007c-.364.612-.545 1.309-.545 2.089 0 .791.187 1.495.561 2.113.373.617.88 1.102 1.519 1.455zm.943-5.607a2.104 2.104 0 0 1 1.105-.285c.401 0 .74.084 1.016.252s.487.409.634.724c.07.151.124.321.165.506l-3.782.011c.039-.143.077-.286.139-.412.169-.341.409-.607.724-.796zM61.589 25.17c-.461.195-1.01.293-1.65.293-.53 0-1.016-.092-1.455-.276a3.37 3.37 0 0 1-1.145-.788 3.506 3.506 0 0 1-.747-1.211 4.432 4.432 0 0 1-.26-1.56c0-.563.086-1.081.26-1.552a3.51 3.51 0 0 1 .747-1.219 3.263 3.263 0 0 1 1.145-.78 3.82 3.82 0 0 1 1.455-.268c.607 0 1.138.098 1.593.293s.84.466 1.154.812l1.496-1.495a5.971 5.971 0 0 0-1.836-1.227c-.694-.297-1.496-.447-2.406-.447-.844 0-1.622.152-2.331.455a5.993 5.993 0 0 0-1.87 1.251c-.536.531-.948 1.154-1.235 1.869s-.43 1.484-.43 2.308.143 1.593.43 2.308.699 1.34 1.235 1.877c.537.536 1.162.953 1.877 1.251s1.49.447 2.324.447c.932 0 1.75-.147 2.454-.439s1.321-.704 1.853-1.236l-1.495-1.495a3.169 3.169 0 0 1-1.162.828zM67.756 22.847c0-.314.068-.59.204-.828.135-.239.322-.423.561-.553.238-.13.509-.194.812-.194.466 0 .845.146 1.138.438.293.293.439.672.439 1.138v4.502h2.13v-4.973c0-.596-.13-1.121-.39-1.576s-.621-.813-1.081-1.073c-.461-.26-.989-.39-1.585-.39s-1.124.13-1.584.39a2.833 2.833 0 0 0-.643.501V15.6h-2.129v11.75h2.129v-4.502zM82.513 27.349v-7.85h-2.114v.779a2.763 2.763 0 0 0-.763-.6c-.445-.228-.948-.341-1.511-.341-.716 0-1.36.179-1.935.536a3.742 3.742 0 0 0-1.349 1.463c-.325.617-.487 1.316-.487 2.096 0 .769.163 1.462.487 2.08a3.739 3.739 0 0 0 1.349 1.462 3.581 3.581 0 0 0 1.935.537c.563 0 1.066-.117 1.511-.349.301-.158.545-.368.763-.603v.789h2.114zm-2.551-2.398c-.368.396-.851.593-1.447.593-.389 0-.734-.089-1.032-.268a1.853 1.853 0 0 1-.699-.747c-.168-.319-.251-.69-.251-1.113 0-.412.084-.778.251-1.098.168-.319.401-.568.699-.747a1.977 1.977 0 0 1 1.032-.268c.401 0 .75.089 1.048.268s.531.428.699.747c.168.32.252.685.252 1.098 0 .628-.185 1.141-.552 1.536zM86.446 22.847c0-.314.068-.59.204-.828.135-.239.322-.423.561-.553.238-.13.509-.194.812-.194.466 0 .845.146 1.138.438s.439.672.439 1.138v4.502h2.13v-4.973c0-.53-.13-1.026-.39-1.487-.26-.46-.618-.834-1.073-1.121s-.969-.431-1.544-.431c-.596 0-1.129.13-1.6.39a2.892 2.892 0 0 0-.675.524V19.5h-2.129v7.85h2.129v-4.502zM95.071 26.975c.639.358 1.359.537 2.161.537.618 0 1.187-.114 1.707-.342.52-.227.981-.558 1.381-.991l-1.381-1.381c-.207.238-.453.42-.74.545s-.609.187-.967.187c-.389 0-.739-.09-1.048-.268a1.937 1.937 0 0 1-.731-.747 2.204 2.204 0 0 1-.268-1.097c0-.423.089-.788.268-1.098.179-.308.423-.552.731-.731a2.054 2.054 0 0 1 1.048-.268c.346 0 .664.061.951.179.287.12.533.293.74.521l1.365-1.382c-.38-.422-.829-.747-1.349-.975s-1.089-.341-1.707-.341c-.791 0-1.509.181-2.154.544a4.043 4.043 0 0 0-1.519 1.471c-.368.617-.552 1.316-.552 2.096 0 .769.184 1.462.552 2.08s.872 1.105 1.512 1.462zM107.04 19.832c-.58-.341-1.249-.512-2.007-.512a4.113 4.113 0 0 0-3.583 2.007c-.364.612-.545 1.308-.545 2.089 0 .791.187 1.495.561 2.113a4 4 0 0 0 1.519 1.455c.639.352 1.371.528 2.194.528.639 0 1.232-.114 1.779-.342a3.628 3.628 0 0 0 1.389-1.007l-1.251-1.252c-.239.271-.52.474-.845.609a2.796 2.796 0 0 1-1.089.204c-.444 0-.834-.095-1.17-.285s-.593-.46-.772-.812a2.39 2.39 0 0 1-.157-.45l5.723-.014a3.946 3.946 0 0 0 .115-.926c0-.747-.166-1.417-.496-2.007s-.785-1.056-1.365-1.398zm-3.112 1.544a2.103 2.103 0 0 1 1.105-.284c.401 0 .74.084 1.016.252.276.169.487.409.634.724.07.151.124.321.165.506l-3.783.011c.039-.143.077-.286.139-.412.169-.342.409-.606.724-.797zM114.378 19.336c-.877 0-1.549.279-2.014.837l-.017.025v-.699h-2.129v7.85h2.129V23.01c0-.586.144-1.022.431-1.308.287-.287.658-.43 1.113-.43.217 0 .409.032.577.097.169.065.311.163.431.292l1.332-1.527a2.252 2.252 0 0 0-.828-.61 2.688 2.688 0 0 0-1.024-.187zM120.571 24.482l-1.795-4.983h-2.308l2.976 7.174-1.871 3.958h2.259l1.431-3.218 3.494-7.914h-2.324zM131.598 15.923h-2.211v11.426H136.831v-1.967h-5.233zM143.614 20.278a2.753 2.753 0 0 0-.764-.6c-.445-.228-.948-.341-1.511-.341-.716 0-1.36.179-1.935.536a3.742 3.742 0 0 0-1.349 1.463c-.325.617-.487 1.316-.487 2.096 0 .769.163 1.462.487 2.08a3.739 3.739 0 0 0 1.349 1.462 3.581 3.581 0 0 0 1.935.537c.563 0 1.066-.117 1.511-.349.301-.158.545-.368.764-.603v.789h2.113v-7.85h-2.113v.779zm-.438 4.673c-.368.396-.851.593-1.447.593-.389 0-.734-.089-1.032-.268a1.853 1.853 0 0 1-.699-.747c-.168-.319-.251-.69-.251-1.113 0-.412.084-.778.251-1.098.168-.319.401-.568.699-.747a1.977 1.977 0 0 1 1.032-.268c.401 0 .75.089 1.048.268s.531.428.699.747c.169.32.252.685.252 1.098 0 .628-.185 1.141-.552 1.536zM153.417 19.767a2.832 2.832 0 0 0-1.544-.431c-.596 0-1.129.13-1.6.39a2.892 2.892 0 0 0-.675.524v-.752h-2.129v7.85h2.129v-4.502c0-.314.068-.59.204-.828.135-.239.322-.423.561-.553.238-.13.509-.194.812-.194.466 0 .845.146 1.138.438.293.293.439.672.439 1.138v4.502h2.13v-4.973c0-.53-.13-1.026-.39-1.487a3.13 3.13 0 0 0-1.073-1.121zM163.495 21.23a3.68 3.68 0 0 0-1.365-1.398c-.58-.341-1.249-.512-2.007-.512a4.113 4.113 0 0 0-3.583 2.007c-.364.612-.545 1.308-.545 2.089 0 .791.187 1.495.561 2.113a4 4 0 0 0 1.519 1.455c.639.352 1.371.528 2.194.528.639 0 1.232-.114 1.779-.342a3.628 3.628 0 0 0 1.389-1.007l-1.251-1.252c-.239.271-.52.474-.845.609a2.796 2.796 0 0 1-1.089.204c-.444 0-.834-.095-1.17-.285s-.593-.46-.772-.812a2.39 2.39 0 0 1-.157-.45l5.723-.014a3.946 3.946 0 0 0 .115-.926c0-.747-.166-1.417-.496-2.007zm-4.478.146a2.103 2.103 0 0 1 1.105-.284c.401 0 .74.084 1.016.252.276.169.487.409.634.724.07.151.124.321.165.506l-3.783.011c.039-.143.077-.286.139-.412.169-.342.409-.606.724-.797zM62.13 31.96c-.58-.292-1.233-.439-1.958-.439H55.67v11.425h2.211v-4.242h2.292c.725 0 1.378-.146 1.958-.438a3.383 3.383 0 0 0 1.373-1.243c.336-.537.505-1.173.505-1.91s-.169-1.374-.505-1.91a3.369 3.369 0 0 0-1.373-1.243zm-.577 4.12a1.614 1.614 0 0 1-.666.61 2.078 2.078 0 0 1-.943.211H57.88v-3.576h2.064c.346 0 .661.07.943.211s.504.347.666.618c.163.27.244.59.244.959 0 .379-.081.702-.244.966zM69.787 34.934c-.877 0-1.549.279-2.014.837l-.017.025v-.699h-2.129v7.849h2.129v-4.339c0-.586.144-1.022.431-1.308.287-.288.658-.431 1.113-.431.217 0 .409.033.577.098.169.065.311.163.431.292l1.332-1.528a2.25 2.25 0 0 0-.828-.609 2.688 2.688 0 0 0-1.024-.187zM79.588 41.085c.368-.623.553-1.319.553-2.088s-.185-1.46-.553-2.073a4.087 4.087 0 0 0-1.503-1.462c-.634-.363-1.352-.545-2.153-.545-.78 0-1.49.182-2.129.545-.64.363-1.143.85-1.512 1.462-.368.612-.552 1.303-.552 2.073s.187 1.465.561 2.088a4.107 4.107 0 0 0 1.511 1.479c.634.363 1.346.545 2.137.545s1.503-.182 2.137-.545 1.135-.856 1.503-1.479zm-1.877-.974c-.169.32-.407.569-.716.747a2.082 2.082 0 0 1-1.064.268c-.389 0-.737-.09-1.04-.268a1.878 1.878 0 0 1-.715-.747c-.174-.319-.261-.685-.261-1.097s.087-.775.261-1.089c.172-.314.411-.561.715-.74.303-.179.65-.268 1.04-.268.401 0 .753.089 1.057.268.303.179.542.426.715.74s.26.677.26 1.089-.084.778-.251 1.097zM82.855 31.391c-.347 0-.634.12-.862.358s-.342.526-.342.862c0 .347.114.636.342.869s.514.349.862.349c.357 0 .647-.116.869-.349s.333-.523.333-.869c0-.336-.111-.624-.333-.862s-.512-.358-.869-.358zM81.766 43.515c0 .314-.092.553-.276.716a1 1 0 0 1-.683.244 1.16 1.16 0 0 1-.512-.106 1.215 1.215 0 0 1-.414-.349l-1.349 1.349c.304.335.642.595 1.016.78.373.184.843.276 1.405.276.553 0 1.048-.116 1.487-.349s.791-.568 1.057-1.007.398-.967.398-1.585v-8.385h-2.129v8.418zM91.459 35.43c-.58-.342-1.249-.512-2.007-.512a4.113 4.113 0 0 0-3.583 2.007c-.364.612-.545 1.308-.545 2.089 0 .791.187 1.495.561 2.113a4 4 0 0 0 1.519 1.455c.639.352 1.371.528 2.194.528.639 0 1.232-.114 1.779-.342a3.646 3.646 0 0 0 1.389-1.007l-1.251-1.252c-.239.271-.52.474-.845.609a2.796 2.796 0 0 1-1.089.204c-.444 0-.834-.095-1.17-.285s-.593-.46-.772-.812a2.39 2.39 0 0 1-.157-.45l5.723-.014a4.015 4.015 0 0 0 .114-.926c0-.747-.166-1.417-.496-2.007s-.785-1.057-1.365-1.398zm-3.112 1.544a2.103 2.103 0 0 1 1.105-.284c.401 0 .74.084 1.016.251.276.169.487.409.634.724.07.151.124.321.165.506l-3.783.011c.039-.143.077-.286.139-.412.169-.342.409-.606.724-.797zM99.391 40.94a2.397 2.397 0 0 1-.967.187c-.389 0-.739-.09-1.048-.268a1.937 1.937 0 0 1-.731-.747 2.204 2.204 0 0 1-.268-1.097c0-.423.089-.788.268-1.098.179-.308.423-.552.731-.731a2.054 2.054 0 0 1 1.048-.268c.346 0 .664.059.951.178.287.12.533.293.74.521l1.365-1.381c-.38-.423-.829-.748-1.349-.976s-1.089-.341-1.707-.341c-.791 0-1.509.182-2.154.545s-1.151.853-1.519 1.471c-.368.617-.552 1.316-.552 2.096 0 .769.184 1.462.552 2.08s.872 1.105 1.512 1.462c.639.358 1.359.537 2.161.537.618 0 1.187-.114 1.707-.342s.981-.558 1.381-.991l-1.381-1.381a2.06 2.06 0 0 1-.74.545zM105.948 31.83h-2.13v3.267h-1.836v1.869h1.836v5.981h2.13v-5.981h1.837v-1.869h-1.837z"></path></svg>
  </div>
	<div class="center-wrapper">
	  <div class="section">
		<h1>Check if your contracts are climate aligned</h1>


		<!-- Display error message if there is an error in the query params -->
		<div id="errorBanner" class="error-banner hidden">
			<p id="errorMessage"></p>
		</div>

		<div id="selectionStep">
			<button class="custom-btn" id="selectFile">
			  <svg width="114" height="109" viewBox="0 0 114 109" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M42.8409 91.8473C33.6144 88.0812 27.2381 79.7718 23.0959 71.4655C19.3815 64.0171 21.4534 56.2808 21.1883 48.4278C20.9019 39.9444 15.6914 29.8379 21.4833 23.6989C27.2761 17.559 39.0142 20.8331 48.23 19.7657C56.7627 18.7773 64.9578 14.7481 73.3954 17.6859C82.0301 20.6924 87.9315 28.1286 92.8527 35.3028C97.6822 42.3433 101.12 50.071 100.999 57.9263C100.876 65.8478 97.4633 73.054 92.1773 78.924C86.8202 84.8729 79.5004 88.8894 71.1449 91.0781C62.0814 93.4522 52.0554 95.6085 42.8409 91.8473Z" fill="#DADDF3"/>
				<path d="M86.4275 26.5972H38.4907V87.5159H86.4275V26.5972Z" fill="white"/>
				<path d="M83.3054 89.0889H41.6131C39.0308 89.0889 36.918 86.9761 36.918 84.3938V29.7195C36.918 27.1372 39.0308 25.0244 41.6131 25.0244H83.3054C85.8877 25.0244 88.0005 27.1372 88.0005 29.7195V84.3938C88.0005 86.9996 85.9112 89.0889 83.3054 89.0889ZM43.1155 85.9432H81.803C83.4932 85.9432 84.8548 84.5816 84.8548 82.8913V31.2219C84.8548 29.5317 83.4932 28.1701 81.803 28.1701H43.1155C41.4252 28.1701 40.0637 29.5317 40.0637 31.2219V82.8913C40.0637 84.5816 41.4252 85.9432 43.1155 85.9432Z" fill="#1F2B55"/>
				<path d="M76.9678 40.6355H46.4732C45.6046 40.6355 44.9004 39.9312 44.9004 39.0626C44.9004 38.194 45.6046 37.4897 46.4732 37.4897H76.9678C77.8364 37.4897 78.5407 38.194 78.5407 39.0626C78.5407 39.9312 77.8364 40.6355 76.9678 40.6355Z" fill="#1F2B55"/>
				<path d="M76.9678 45.7531H46.4732C45.6046 45.7531 44.9004 45.0489 44.9004 44.1803C44.9004 43.3117 45.6046 42.6074 46.4732 42.6074H76.9678C77.8364 42.6074 78.5407 43.3117 78.5407 44.1803C78.5407 45.0489 77.8364 45.7531 76.9678 45.7531Z" fill="#1F2B55"/>
				<path d="M68.0242 50.7771H46.4503C45.5817 50.7771 44.8774 50.0728 44.8774 49.2042C44.8774 48.3356 45.5817 47.6313 46.4503 47.6313H68.0242C68.8928 47.6313 69.5971 48.3356 69.5971 49.2042C69.5971 50.0728 68.8928 50.7771 68.0242 50.7771Z" fill="#1F2B55"/>
				<path d="M76.9678 57.1457H46.4732C45.6046 57.1457 44.9004 56.4414 44.9004 55.5728C44.9004 54.7043 45.6046 54 46.4732 54H76.9678C77.8364 54 78.5407 54.7043 78.5407 55.5728C78.5407 56.4414 77.8364 57.1457 76.9678 57.1457Z" fill="#1F2B55"/>
				<path d="M76.9678 73.1457H46.4732C45.6046 73.1457 44.9004 72.4414 44.9004 71.5728C44.9004 70.7043 45.6046 70 46.4732 70H76.9678C77.8364 70 78.5407 70.7043 78.5407 71.5728C78.5407 72.4414 77.8364 73.1457 76.9678 73.1457Z" fill="#1F2B55"/>
				<path d="M76.9678 62.2634H46.4732C45.6046 62.2634 44.9004 61.5591 44.9004 60.6905C44.9004 59.8219 45.6046 59.1177 46.4732 59.1177H76.9678C77.8364 59.1177 78.5407 59.8219 78.5407 60.6905C78.5407 61.5591 77.8364 62.2634 76.9678 62.2634Z" fill="#1F2B55"/>
				<path d="M76.9678 78.2634H46.4732C45.6046 78.2634 44.9004 77.5591 44.9004 76.6905C44.9004 75.8219 45.6046 75.1177 46.4732 75.1177H76.9678C77.8364 75.1177 78.5407 75.8219 78.5407 76.6905C78.5407 77.5591 77.8364 78.2634 76.9678 78.2634Z" fill="#1F2B55"/>
				<path d="M68.0242 67.2873H46.4503C45.5817 67.2873 44.8774 66.583 44.8774 65.7145C44.8774 64.8459 45.5817 64.1416 46.4503 64.1416H68.0242C68.8928 64.1416 69.5971 64.8459 69.5971 65.7145C69.5971 66.583 68.8928 67.2873 68.0242 67.2873Z" fill="#1F2B55"/>
				<path d="M38.9376 83.4079C47.8187 83.4079 55.0183 76.2084 55.0183 67.3273C55.0183 58.4461 47.8187 51.2466 38.9376 51.2466C30.0565 51.2466 22.8569 58.4461 22.8569 67.3273C22.8569 76.2084 30.0565 83.4079 38.9376 83.4079Z" fill="#D7288B"/>
				<path d="M36.6837 74.0175L31.3079 68.9703C31.0027 68.6886 30.9792 68.2191 31.2844 67.9139L32.4582 66.6697C32.7399 66.3645 33.2094 66.341 33.5145 66.6462L36.6837 69.6041C36.8246 69.745 37.0593 69.7215 37.1767 69.5806L44.102 60.9652C44.3367 60.6834 44.7358 60.6365 45.0175 60.8713L46.4965 62.0685C46.7782 62.3033 46.8251 62.7023 46.5904 62.984L37.7636 73.9705C37.4584 74.2523 36.9889 74.2992 36.6837 74.0175Z" fill="#FFFDFF"/>
			  </svg>
			  <span>Check a single contract</span>
			</button>

			<button class="custom-btn" id="selectFolder">
			  <svg width="114" height="109" viewBox="0 0 114 109" fill="none" xmlns="http://www.w3.org/2000/svg">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M42.8409 91.8473C33.6144 88.0812 27.2381 79.7718 23.0959 71.4655C19.3815 64.0171 21.4534 56.2808 21.1883 48.4278C20.9019 39.9444 15.6914 29.8379 21.4833 23.6989C27.2761 17.559 39.0142 20.8331 48.23 19.7657C56.7627 18.7773 64.9578 14.7481 73.3954 17.6859C82.0301 20.6924 87.9315 28.1286 92.8527 35.3028C97.6822 42.3433 101.12 50.071 100.999 57.9263C100.876 65.8478 97.4633 73.054 92.1773 78.924C86.8202 84.8729 79.5004 88.8894 71.1449 91.0781C62.0814 93.4522 52.0554 95.6085 42.8409 91.8473Z" fill="#DADDF3"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M57.4095 30.3576H87.7859C90.6694 30.3866 92.9913 32.7146 93 35.584V77.7679C92.9971 80.6373 90.6723 82.971 87.7859 83H31.2141C28.3277 82.971 26.0029 80.6373 26 77.7679V31.2321C26.0029 28.3483 28.3509 26.0087 31.2519 26H51.8318C53.243 25.9942 54.5727 26.6486 55.4223 27.772L57.4125 30.3577L57.4095 30.3576Z" fill="white"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M90.2358 39.1569V35.5839C90.23 34.2346 89.1417 33.1372 87.7859 33.1083H59.5189L63.153 37.8453C63.4789 38.2883 64.0026 38.5431 64.5526 38.5257H87.7857C88.6557 38.5257 89.5111 38.7429 90.2734 39.1569L90.2358 39.1569ZM57.4095 30.3576H87.7859C90.6694 30.3866 92.9913 32.7146 93 35.584V77.7679C92.9971 80.6373 90.6723 82.971 87.7859 83H31.2141C28.3277 82.971 26.0029 80.6373 26 77.7679V31.2321C26.0029 28.3483 28.3509 26.0087 31.2519 26H51.8318C53.243 25.9942 54.5727 26.6486 55.4223 27.772L57.4125 30.3577L57.4095 30.3576ZM55.6899 32.6392L60.9709 39.5044C61.8205 40.6249 63.1502 41.2822 64.5614 41.2764H87.7863C89.1567 41.2851 90.2653 42.3882 90.274 43.752V77.7682C90.2711 79.1349 89.1596 80.2438 87.7863 80.2496H31.2144C29.8411 80.2438 28.7296 79.1349 28.7267 77.7682V31.2324C28.7296 29.8657 29.8411 28.7569 31.2144 28.751H51.8323C52.3852 28.7307 52.9118 28.9913 53.2319 29.4401L55.577 32.4948C55.577 32.547 55.6527 32.5904 55.6876 32.6425L55.6899 32.6392ZM47.7206 75.3361H84.8969C85.6185 75.284 86.1801 74.6846 86.1801 73.9607C86.1801 73.2398 85.6185 72.6404 84.8969 72.5854H47.7206C46.9961 72.6404 46.4345 73.2397 46.4345 73.9607C46.4345 74.6846 46.9961 75.284 47.7206 75.3361ZM34.0687 75.3361H40.7201H40.7172C41.1013 75.3651 41.4795 75.2319 41.7617 74.9713C42.044 74.7107 42.204 74.3458 42.204 73.9607C42.204 73.5785 42.044 73.2137 41.7617 72.9502C41.4795 72.6896 41.1013 72.5593 40.7172 72.5854H34.0658C33.3442 72.6404 32.7826 73.2398 32.7826 73.9608C32.7826 74.6846 33.3442 75.284 34.0658 75.3361L34.0687 75.3361ZM83.6984 47.7857H63.0634V54.8941H83.6954L83.6984 47.7857ZM61.7159 45.0351C60.9507 45.0351 60.3309 45.6518 60.3309 46.4133V56.2725C60.3309 56.6374 60.4764 56.9877 60.7353 57.2454C60.9972 57.5031 61.3493 57.645 61.7159 57.6421H85.1032C85.8655 57.6421 86.4824 57.0283 86.4824 56.2725V46.4133C86.4853 46.0485 86.3398 45.6981 86.0809 45.4375C85.8219 45.1798 85.4698 45.0351 85.1032 45.0351L61.7159 45.0351Z" fill="#1F2B55"/>
				<path d="M33.0807 77.1613C41.9618 77.1613 49.1613 69.9618 49.1613 61.0807C49.1613 52.1996 41.9618 45 33.0807 45C24.1996 45 17 52.1996 17 61.0807C17 69.9618 24.1996 77.1613 33.0807 77.1613Z" fill="#D7288B"/>
				<path d="M30.8268 67.7709L25.4509 62.7237C25.1457 62.442 25.1223 61.9725 25.4274 61.6673L26.6012 60.4231C26.8829 60.1179 27.3524 60.0944 27.6576 60.3996L30.8268 63.3575C30.9677 63.4984 31.2024 63.4749 31.3198 63.3341L38.245 54.7186C38.4798 54.4369 38.8789 54.3899 39.1606 54.6247L40.6395 55.8219C40.9212 56.0567 40.9682 56.4558 40.7334 56.7375L31.9067 67.724C31.6015 68.0057 31.132 68.0526 30.8268 67.7709Z" fill="#FFFDFF"/>
			  </svg>
			  <span>Check a folder of contracts</span>
			</button>
		</div>

	  </div>



		<!-- Step 1: Choose "File" or "Folder" -->


		<!-- Step 2: File Upload -->
		<form id="uploadForm" class="hidden">

		  <h2>Before you upload your contracts</h2>
		  <ul>
			<li>Remove any personally identifiable information</li>
			<li>Save it as a TXT file</li>
		  </ul>

		  <h2>How your contracts are used</h2>
		  <ul>
		  <li>The content in your contracts are only used to identify climate aligned wording</li>
		  <li>Your contract is deleted immediately after it is analysed. It is not stored or used elsewhere</li>
		  </ul>

			<div class="govuk-form-group">
			  <h2 id="uploadLabel"></h2>
			  <label class="govuk-label" for="uploadInput">
				Upload a file
			  </label>
			  <input class="govuk-file-upload" id="uploadInput" name="file" type="file" multiple>
			</div>

			<button type="submit" class="cfc-button">Continue</button>
		</form>

		<div id="loading" class="loading hidden">
			<p>Loading your results</p>
			<div class="progress-bar">
				<div id="progressBar" class="progress-bar-inner"></div>
			</div>
		</div>
		<div id="result" class="result hidden"></div>
	</div>

	<script>
		const selectFileButton = document.getElementById("selectFile");
		const selectFolderButton = document.getElementById("selectFolder");
		const uploadForm = document.getElementById("uploadForm");
		const uploadLabel = document.getElementById("uploadLabel");
		const uploadInput = document.getElementById("uploadInput");
		const resultDiv = document.getElementById("result");
		const loadingDiv = document.getElementById("loading");
		const progressBar = document.getElementById("progressBar");
		const errorBanner = document.getElementById("errorBanner");
		const errorMessage = document.getElementById("errorMessage");
		



		const MAX_FILE_LIMIT = 1000;

		let isFolderUpload = false;
		function hideErrorBanner() {
			errorBanner.classList.add("hidden");
		}

		function toggleDocumentList(listId) {
			const list = document.getElementById(listId);
			const docCount = document.querySelector(`[onclick="toggleDocumentList('${listId}')"]`);
			const arrow = docCount.querySelector(".toggle-arrow");

			if (list.classList.contains('hidden')) {
				list.classList.remove('hidden');
				arrow.textContent = '▼'; // Expanded state
			} else {
				list.classList.add('hidden');
				arrow.textContent = '▶'; // Collapsed state
			}
		}
		function renderBucket(bucketKey, bucketLabel, bucket, percentage, downloadLink) {
			if (bucket.count === 0) {
				return `
					<div class="result-blk ${bucketKey}">
						<span class="percentage">${bucket.count} contracts (${percentage}%) </span>
						<span class="desc">are <strong>${bucketLabel}</strong> to contain climate aligned clauses</span>
					</div>
				`;
			} else {
				return `
					<div class="result-blk ${bucketKey}">
						<span class="percentage">${bucket.count} contracts (${percentage}%) </span>
						<span class="desc">are <strong>${bucketLabel}</strong> to contain climate aligned clauses</span>
						<a class="toggle-link" onclick="toggleDocumentList('${bucketKey}-list')">
						  <span class="toggle-arrow">▶</span>View the contracts
						</a>
						<div id="${bucketKey}-list" class="doc-list hidden">
							<ul>
								${bucket.documents.map(doc => `<li>${doc}</li>`).join('')}
							</ul>
						</div>
						<a href="${downloadLink}" target="_blank">Download as a zip file</a>
					</div>
				`;
			}
		}

		function scrollToHighlightedText(event, highlightId) {
			event.preventDefault();
			const highlightElement = document.getElementById(highlightId);

			if (highlightElement) {
				highlightElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
			}
		}

		//handle "Upload File" selection
		selectFileButton.addEventListener("click", () => {
			isFolderUpload = false;
			uploadLabel.innerText = "Upload a single contract";
			uploadInput.removeAttribute("webkitdirectory");
			uploadInput.removeAttribute("directory");
			uploadInput.setAttribute("accept", ".txt");
			showUploadForm();
			hideErrorBanner();
		});

		//handle "Upload Folder" selection
		selectFolderButton.addEventListener("click", () => {
			isFolderUpload = true;
			uploadLabel.innerText = "Upload a folder of contracts";
			uploadInput.removeAttribute("accept");
			uploadInput.setAttribute("webkitdirectory", true);
			uploadInput.setAttribute("directory", true);
			showUploadForm();
			hideErrorBanner();
		});

		function showUploadForm() {
			document.getElementById("selectionStep").classList.add("hidden");
			uploadForm.classList.remove("hidden");
		}

		uploadForm.addEventListener("submit", async function (event) {
			event.preventDefault();

			//hide any previously shown results and error banner
			resultDiv.classList.add("hidden");
			errorBanner.classList.add("hidden");
			loadingDiv.classList.remove("hidden");
		   selectionStep.classList.add("hidden");
		   uploadForm.classList.add("hidden");
			progressBar.style.width = "0%";

			if (!uploadInput.files.length) {
				alert("Please upload a file or folder.");
				loadingDiv.classList.add("hidden");
				return;
			}

			//check the number of files
			if (uploadInput.files.length > MAX_FILE_LIMIT) {
				//redirect to the home screen with an error message
				window.location.href = '/?error=too-many-files';
				return;
			}

			const formData = new FormData();
			for (const file of uploadInput.files) {
				formData.append("files", file);
			}

			formData.append("is_folder", isFolderUpload ? "true" : "false");

			//progress bar
			let progress = 0;
			const progressInterval = setInterval(() => {
				if (progress < 90) {
					progress += 10;
					progressBar.style.width = progress + "%";
				}
			}, 500);

			const baseUrl = `${window.location.protocol}//${window.location.host}`;

			const response = await fetch(`${baseUrl}/process/`, {
				method: "POST",
				body: formData,
			});

			try {
				const result = await response.json();

				clearInterval(progressInterval);  //stop the progress bar once we have the response
				progressBar.style.width = "100%"; //complete the progress bar

				loadingDiv.classList.add("hidden");

				if (!response.ok) {
					const error = result.error || "An error occurred while processing.";
					resultDiv.classList.remove("hidden");
					resultDiv.innerHTML = `<p style="color: red;">${error}</p>`;

					//redirect to the home screen
					window.location.href = '/?error=processing-failed';
					return;
				}

				//results for both folder and file uploads

				//Al: Buckets is the name of a dictionary that contains the count and names of the document (count and documents as variable names)
				if (isFolderUpload) {
					const percentages = result.percentages;
					const links = result.download_links;
					const buckets = result.buckets;

					uploadForm.classList.add("hidden");
					resultDiv.classList.remove("hidden");

					resultDiv.innerHTML = `
						<h2>Result for multiple contracts</h2>
						<div class="detection-result multiple">

							${renderBucket('extremely-likely', 'extremely likely', buckets.extremely_likely, percentages.extremely_likely, links.extremely_likely_zip)}
							${renderBucket('very-likely', 'very likely', buckets.very_likely, percentages.very_likely, links.very_likely_zip)}
							${renderBucket('likely', 'likely', buckets.likely, percentages.likely, links.likely_zip)}
							${renderBucket('unlikely', 'not likely', buckets.none, percentages.not_likely, links.none_zip)}

						</div>

					   <div class='report-findings'>
						  <div class='report-findings-inner'>
							<h3>See how your results compare to other [sectors / industries / etc]</h3>
							<p>Similique est fuga et cumque. Voluptas voluptatem voluptas voluptatum placeat natus consequatur quas sed dolorum.</p>
							<a href='#' class='cfc-button'>Report anonymised results</a>
						  </div>
					   </div>
					`;
				} else {
					const classification = result.classification;
					const highlight = result.highlighted_content;

					uploadForm.classList.add("hidden");
					resultDiv.classList.remove("hidden");

					if (classification === "unlikely") {
						// Render result for "unlikely" classification
						resultDiv.innerHTML = `
							<h2>Result for the single contract</h2>
							<div class="detection-result single">
								<div class='result-blk unlikely'>
									<strong>It is ${classification}</strong>
									<span class='desc'>that this contract contains climate aligned clauses.</span>
									<a data-fancybox data-src='#contract-text-original' href='#'>View the original text</a>
								</div>
							</div>
							
						  <div id="contract-text-original" class="contract-listing hidden">
								<h1>Original contract text</h1>
							   <div class='highlighted-text-wrapper'>
								${highlight}
							   </div>
								<button data-fancybox-close type="submit" class="cfc-button cfc-button--secondary">Close</button>
							</div>

						  <div id='guideReccomendations' class='border-section'>
							  <h2>Improve the result for this contract</h2>
							  <div class='cfc-cards-grid grid-count--2 grid-size--small cards-type--guide-summary-card-small '>
								<div class='card-1 cfc-card has-post-thumbnail'><div class='cfc-card__inner'><div class='cfc-card__content'><span class='cfc-card__type'>Guide</span><h3 class='cfc-card__heading'><a class='cfc-card__link' href='https://chancerylaneproject.org/guides/get-information-on-contract-emission'>Get information on contract emissions</a></h3><div class='cfc-card__description'>Gather data on emissions related to contracts to help measure, manage and report on them</div></div><figure class='cfc-card__image'><picture><img alt='' decoding='async' loading='lazy' src='https://chancerylaneproject.org/wp-content/uploads/2024/04/Get-information-on-contract-emissions-640x384.png'></picture></figure></div></div>
								<div class='card-2 cfc-card has-post-thumbnail'><div class='cfc-card__inner'><div class='cfc-card__content'><span class='cfc-card__type'>Guide</span><h3 class='cfc-card__heading'><a class='cfc-card__link' href='https://chancerylaneproject.org/guides/request-climate-information-in-due-diligence-questionnaires/'>Request climate information in due diligence questionnaires</a></h3><div class='cfc-card__description'>Assess the climate performance of other organisations and how they will impact your transition plan</div></div><figure class='cfc-card__image'><picture><img alt='' decoding='async' loading='lazy' src='https://chancerylaneproject.org/wp-content/uploads/2024/04/Request-climate-information-in-due-diligence-questionnaires-640x384.png'></picture></figure></div></div>
							  </div>
							</div>
						`;
					} else {
						// Render result for other classifications
						resultDiv.innerHTML = `
							<h2>Result for the single contract</h2>
							<div class="detection-result single">
								<div class='result-blk extremely-likely'>
									<strong>It is ${classification}</strong>
									<span class='desc'>that this contract contains climate aligned clauses.</span>
									<a data-fancybox data-src='#contract-text-highlight' href='#'>View the text identified</a>
								</div>
							</div>
							<div id="contract-text-highlight" class="contract-listing hidden">
								<h1>Original contract text</h1>
								<a class='cfc-button' href='#' onclick="scrollToHighlightedText(event, 'first-highlight')">Skip to climate aligned text</a>
							   <div class='highlighted-text-wrapper'>
								${highlight}
							   </div>
								<button data-fancybox-close type="submit" class="cfc-button cfc-button--secondary">Close</button>
							</div>

							<div id='guideReccomendations' class='border-section'>
							  <h2>Improve the result for this contract</h2>
							  <div class='cfc-cards-grid grid-count--2 grid-size--small cards-type--guide-summary-card-small '>
								<div class='card-1 cfc-card has-post-thumbnail'><div class='cfc-card__inner'><div class='cfc-card__content'><span class='cfc-card__type'>Guide</span><h3 class='cfc-card__heading'><a class='cfc-card__link' href='https://chancerylaneproject.org/guides/get-information-on-contract-emission'>Get information on contract emissions</a></h3><div class='cfc-card__description'>Gather data on emissions related to contracts to help measure, manage and report on them</div></div><figure class='cfc-card__image'><picture><img alt='' decoding='async' loading='lazy' src='https://chancerylaneproject.org/wp-content/uploads/2024/04/Get-information-on-contract-emissions-640x384.png'></picture></figure></div></div>
								<div class='card-2 cfc-card has-post-thumbnail'><div class='cfc-card__inner'><div class='cfc-card__content'><span class='cfc-card__type'>Guide</span><h3 class='cfc-card__heading'><a class='cfc-card__link' href='https://chancerylaneproject.org/guides/request-climate-information-in-due-diligence-questionnaires/'>Request climate information in due diligence questionnaires</a></h3><div class='cfc-card__description'>Assess the climate performance of other organisations and how they will impact your transition plan</div></div><figure class='cfc-card__image'><picture><img alt='' decoding='async' loading='lazy' src='https://chancerylaneproject.org/wp-content/uploads/2024/04/Request-climate-information-in-due-diligence-questionnaires-640x384.png'></picture></figure></div></div>
							  </div>
							</div>
						`;
					}
				}
			} catch (error) {
				console.error(error);
				loadingDiv.classList.add("hidden");
				resultDiv.classList.remove("hidden");
				resultDiv.innerHTML = `<p style="color: red;">Error processing your request. Please try again.</p>`;
			}
		});

		const urlParams = new URLSearchParams(window.location.search);
		const errorType = urlParams.get('error');

		//show error message
		if (errorType) {
			const errorBanner = document.getElementById("errorBanner");
			const errorMessage = document.getElementById("errorMessage");

			if (errorType === 'too-many-files') {
				errorMessage.textContent = "This server can only handle up to 1000 files; please try again.";
			} else if (errorType === 'processing-failed') {
				errorMessage.textContent = "There was an issue processing your files. Please try again.";
			}

			errorBanner.classList.remove("hidden");

			//clear the query parameter after displaying the banner
			history.replaceState(null, '', window.location.pathname);
		}


	</script>

	<div id="contract-listing-likely" class="contract-listing hidden">
	  <h1>7 contracts likely to be climate aligned</h1>
	  <ul>
		<li>
		  Non Sint Voluptatem Rerum
		  <a href="#">View text [+]</a>
		</li>
		<li>Dolor Aliquam Est Blanditiis Veritatis Nisi Nihil <a href="#">View text [+]</a></li>
		<li>Sunt Incidunt Magni Aut <a href="#">View text [+]</a></li>
		<li>Optio Maxime Sed Rerum Non <a href="#">View text [+]</a></li>
		<li>Hic Expedita Corrupti Laudantium Ut <a href="#">View text [+]</a></li>
		<li>Doloribus Temporibus Sint Sapiente Nihil <a href="#">View text [+]</a></li>
		<li>Earum Ducimus Placeat <a href="#">View text [+]</a></li>
	  </ul>
	  <button data-fancybox-close type="submit" class="cfc-button">Close</button>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
	<script>
	  Fancybox.bind('[data-fancybox]', {
		// Custom options for all galleries
	  });
	</script>
</body>
</html>
